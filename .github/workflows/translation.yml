name: OneSky Translation Sync

on:
  push:
    branches: [ master, main ]
  workflow_dispatch:  # Allow manual triggering

permissions:
  contents: write       # Required to create commits
  pull-requests: write  # Required to create pull requests

jobs:
  sync-translations:
    name: Sync with OneSky
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Sync translations with OneSky
        uses: onesky/public-actions@gha/sync-translations
        env:
          # Required: OneSky API credentials (add these as repository secrets)
          ONESKY_API_KEY: 'eea642ddc9ac8f46b80041ba806cd771'
          ONESKY_WORKSPACE_ID: 'c3e33db9-5fc6-40c1-be3c-a99b062c7b7c'
          ONESKY_PUBLIC_API_URL: 'https://api.oneskyhq-stag.com/v1'
          
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: 'chore: update translations from OneSky'
          title: 'üåê Update translations from OneSky'
          body: |
            ## üåê Translation Updates
            
            Automated translation sync from OneSky platform.
            
            ### Changes
            - ‚úÖ Updated translation files
            - ‚úÖ Synced with latest source content
            - ‚úÖ Applied OneSky configuration from `.oneskyapp.yml`
            
            This pull request was automatically generated by the OneSky Translation Sync workflow.
          branch: 'onesky-translations'
          delete-branch: true
